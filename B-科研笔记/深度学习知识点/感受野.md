## 什么是感受野
“感受野”的概念来源于生物神经科学，比如当我们的“感受器”，比如我们的手受到刺激之后，会将刺激传输至中枢神经，但是并<font color=#ff0000>不是一个神经元就能够接受整个皮肤的刺激</font>，因为皮肤面积大，一个神经元可想而知肯定接受不完，而且我们同时可以感受到身上皮肤在不同的地方，如手、脚，的不同的刺激，如痛、痒等。这说明皮肤感受器是由很多不同的神经元控制的，那么**每一个神经元所能够反映的那块感受器的区域就称之为“感受野”**，感受野即每一个神经元所支配的区域，也可以说这个神经元的活动受到那一块区域的影响。

卷积神经网络中，整个卷积运算的过程正好和上面的皮肤刺激过程类似，我们可以将原始图像对应看成感受器（皮肤），将最终的输出看成是做出反应的那个神经元。最终输出到底是什么状态（神经元的状态）所受到的初始图像哪一块区域的影响（受到那一块皮肤的刺激）不正是上面所描述的过程吗？于是我们给出感受野的定义如下：

<font color=#ff0000>卷积神经网络每一层输出的特征图（feature map）上的像素点在原始图像上映射的区域大小</font>；通俗点说，就是图像的最终输出的每一个特征（每一个像素）到底受到原始图像哪一部分的影响。

![链接](https://img-blog.csdnimg.cn/ca7dc7a834984d4f93d69bd662e76ea3.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAR0l05LiA5LiL5bCx55-l6YGT,size_12,color_FFFFFF,t_70,g_se,x_16)
## 图解说明
为了更好地说明整个卷积神经网络的工作过程，下面以一个例子说明，原始图像的大小为10x10，一共设计了5个网络层，前面4个是卷积层，卷积核的大小为3x3，最后一个是池化层，大小为2x2,为了较简单的说明，本次所有的步幅stride均为1.

注意：感受野在计算的时候不考虑“边界填充”，因为填充的边界已经不是原始图像本身的内容了，感受野描述的是输出特征到原始图像的映射关系，故而不考虑padding 。实际建模过程中可能需要填充边界，原理一样，只是计算稍微复杂点。

1. 第一次卷积运算
![链接](https://img-blog.csdnimg.cn/ab231193858a460bb2b799a6c6cfb1e9.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAR0l05LiA5LiL5bCx55-l6YGT,size_15,color_FFFFFF,t_70,g_se,x_16)
从上面可以看出：第一层网络输出的图像中，输出结果为8x8，output1输出的每一个特征（即每一个像素）受到原始图像的3x3区域内的影响，故而第一层的感受野为3，用字母表示为

RF1=3 （每一个像素值与原始图像的3x3区域有关）

2. 第二次卷积运算
![链接](https://img-blog.csdnimg.cn/6b74cdbbbe3a47feba9576d6a084d155.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAR0l05LiA5LiL5bCx55-l6YGT,size_20,color_FFFFFF,t_70,g_se,x_16)
从上图可以看出，经历两次卷积运算之后，最终的输出图像为6x6，output2输出的每一个特征（即每一个像素）受到output1的范围影响为3x3，而output1中的这个3x3又收到原始图像的5x5的范围的影响，故而第二层的感受野为5，即

RF2=5 （每一个像素值与原始图像的5x5区域有关）

3. 第三次卷积运算
![链接](https://img-blog.csdnimg.cn/7b085293f22748cdb32a09a0c024b761.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAR0l05LiA5LiL5bCx55-l6YGT,size_20,color_FFFFFF,t_70,g_se,x_16)
从上图可以看出，经历三次卷积运算之后，最终的输出图像为4x4，output3输出的每一个特征（即每一个像素）受到output2的范围影响为3x3，而output2中的这个3x3又受到output1的5x5的范围的影响，而output1中的这个5x5又受到原始图像的7x7的范围的影响，故而第三层的感受野为7，即

RF3=7 （每一个像素值与原始图像的7x7区域有关）

4. 第四次卷积运算
![链接](https://img-blog.csdnimg.cn/5d059794c161423ca2efaa28b3cbdd09.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAR0l05LiA5LiL5bCx55-l6YGT,size_20,color_FFFFFF,t_70,g_se,x_16)
从上图可以看出，经历四次卷积运算之后，最终的输出图像为2x2，output4输出的每一个特征（即每一个像素）受到output3的范围影响为3x3，而output3中的这个3x3又受到output2的5x5的范围的影响，而output2中的这个5x5又受到output1的7x7的范围的影响，而output1中的这个7x7又受到原始图形的9x9的范围的影响，故而第四层的感受野为9，即

RF4=9 （每一个像素值与原始图像的9x9区域有关）

5. 第五次卷积运算
![链接](https://img-blog.csdnimg.cn/17942d04cbe74c0b96e7eb211f9ea79a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAR0l05LiA5LiL5bCx55-l6YGT,size_20,color_FFFFFF,t_70,g_se,x_16)
从上图可以看出，经历四次卷积运算和一次池化运算之后，最终的输出图像为1x1，output5输出的每一个特征（即每一个像素）受到output4的范围影响为2x2，而output4中的这个2x2又受到output3的4x4的范围的影响，而output3中的这个4x4又受到output2的6x6的范围的影响，而output2中的这个6x6受到output1的8x8的范围的影响，而output1中的这个8x8受到原始图像的10x10的范围的影响，故而第五层的感受野为10，即

RF5=10 （每一个像素值与原始图像的10x10区域有关）

结论： 从上面的地推过程可以看出，<font color=#ff0000>随着卷积层数的逐渐增加，感受野的范围在逐渐扩大</font>，也就是说，越靠近后面的输出，所受到的图像的像素影响的范围更加宽阔。卷积神经网络正是通过这种层层推进的方式，每一个卷基层都能学习到不同的特征，最后实现相关的识别、分类等功能的。

递推公式

从上面的过程可以看出，感受野的推导是一个递推的过程，下面将展示这一过程。

RF1=3 k1（第一层的感受野，永远等于第一个卷积核的尺寸大小）k表示第几个卷积层

`RF2=5 k1 + (k2-1) RF1+ (k2-1)`

`RF3=7 k1 + (k2-1) + （k3-1) RF2+ (k3-1)`

`RF4=9 k1 + (k2-1) + （k3-1) + (k4-1) RF3+ (k4-1)`

`RF4=10 k1 + (k2-1) + （k3-1) + (k4-1) + (k5-1) RF4+ (k5-1)`

## 感受野的计算
感受野计算时有下面几个知识点需要知道：

1. 最后一层（卷积层或池化层）输出特征图感受野的大小等于卷积核的大小。
2. 第i层卷积层的感受野大小和第i层的卷积核大小和步长有关系，同时也与第（i+1）层感受野大小有关。
3. 计算感受野的大小时忽略了图像边缘的影响，即不考虑padding的大小。
4. 关于感受野大小的计算方式是采用从最后一层往下计算的方法，即先计算最深层在前一层上的感受野，然后逐层传递到第一层，使用的公式可以表示如下：

其中，是第i层卷积层的感受野，是（i+1）层上的感受野，stride是卷积的步长，Ksize是本层卷积核的大小。

注意： 此公式与上边的递归公式在原理上是一致的，一个向前计算一个向后计算。


## 感受野大小对提取特征的影响
1. 感受野大于要提取的特征区域（比如物体）
	会忽略被检测的物体，导致物体成为背景，提取不到物体特征。也就是说对小物体的检测会差一点。
2. 感受野小于要提取的特征区域（比如物体）
	获得的局部信息过多，导致全局信息的丢失，影响识别率。
3. 网络深度越深，卷积的过程中<font color=#ff0000>会丢失信息</font>，所以一般选取大的感受野来保证不丢失过多信息。 当然，对于一些小物体检测长几个可能效果不一定好。

不同大小的卷积核获得不同大小的信息，选取合适的感受野大小比较重要，或者考虑多尺度的感受野，可能会减少1和2这种弊端。