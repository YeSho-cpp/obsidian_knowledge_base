# torch.nn.Conv2d()函数详解
**参数详解**
`torch.nn.Conv2d(in_channels, out_channels, kernel_size, stride=1, padding=0, dilation=1, groups=1, bias=True)`

| 参数                                                                                                                                                                                                                                                                                                                                                                                                                                                  | 参数类型                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|:-:|:-:|:-:|
|<span style="color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; background-color: rgb(249, 242, 244);">in_channels</span>| int                     | 输入图像通道数                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span style="color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; background-color: rgb(249, 242, 244);">out_channels</span> | int                     | 卷积产生的通道数                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span style="color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; background-color: rgb(249, 242, 244);">kernel_size</span>  | (int or tuple)          | 卷积核尺寸，可以设为1个int型数或者一个(int,int)型的元组。例如(2,3)是高2宽3卷积核                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span style="color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; background-color: rgb(249, 242, 244);">stride</span>       | (int or tuple,optional) | 卷积步长，默认为1，可以设为1个int型数或者一个(int,int)型的元组                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span style="color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; background-color: rgb(249, 242, 244);">padding</span>      | (int or tuple,optional) | <span style="color: rgb(79, 79, 79); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; text-align: -webkit-left; background-color: rgb(255, 255, 255);">填充操作，控制</span><code style="outline: 0px; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px; overflow-wrap: break-word; font-variant-ligatures: no-common-ligatures; font-weight: 400; text-align: -webkit-left; user-select: auto; word-break: normal !important;">padding_mode</code><span style="color: rgb(79, 79, 79); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; text-align: -webkit-left; background-color: rgb(255, 255, 255);">的数目。</span> |
| <span style="color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; background-color: rgb(249, 242, 244);">padding_mode</span> | (string,optional)       | <code style="outline: 0px; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px; overflow-wrap: break-word; font-variant-ligatures: no-common-ligatures; font-weight: 400; text-align: -webkit-left; user-select: auto; word-break: normal !important;">padding</code><span style="color: rgb(79, 79, 79); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; text-align: -webkit-left; background-color: rgb(247, 247, 247);">模式，默认为Zero-padding 。</span>                                                                                                                                                                                                                                                                                                                                                                    |
| <span style="color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; background-color: rgb(249, 242, 244);">dilation</span>     | (int or tuple,optional) | <span style="color: rgb(79, 79, 79); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; text-align: -webkit-left; background-color: rgb(255, 255, 255);">扩张操作：控制kernel点（卷积核点）的间距，默认值:1。</span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span style="color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; background-color: rgb(249, 242, 244);">groups</span>       | (int,optional)          | <span style="color: rgb(79, 79, 79); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; text-align: -webkit-left; background-color: rgb(247, 247, 247);">group参数的作用是控制分组卷积，默认不分组，为1组。</span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span style="color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; background-color: rgb(249, 242, 244);">bias</span>         |(bool,optional)| <span style="color: rgb(79, 79, 79); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: no-common-ligatures; text-align: -webkit-left; background-color: rgb(255, 255, 255);">为真，则在输出中添加一个可学习的偏差。默认：True。</span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
dilation操作动图演示如下：
Dilated Convolution with a 3 x 3 kernel and dilation rate 2
扩张卷积核为3×3，扩张率为2

![链接](https://img-blog.csdnimg.cn/20200709215036409.png)
**参数groups——分组卷积**
`Group Convolutio`n顾名思义，则是对输入`feature map`进行分组，然后每组分别卷积。
假设输人`featre map`的尺寸仍为`C*H*W`，输出fetremap的数量为N个，如果设定要分成G个groups，则每组的输出的`featue map`数量为`$C/G$`，每组的输出fetre map数量为N/G，每个卷积核的尺寸为`C/G*K*K`，卷积核的总数仍为N个，每组的卷积核数量为N/G，卷积核只与其问组的输入map进行卷积、卷积核的总参数量为`N*C/G*K*K`，可见，总参数减少为原来的1/G,其连接方式如下图右所示，group1输出的map数为2，有2个卷积核，每个卷积核的channel数为4，与group1的输入map的channel数相同，卷积被只与同组的输入map卷积、而不与其他组的输入map卷积。

![链接](https://img-blog.csdnimg.cn/20200709221342740.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0MjQzOTMw,size_16,color_FFFFFF,t_70)
那么输出张量大小的计算公式为：

$output\_height = \lfloor\frac{input\_height + 2 * padding\_height - (dilation\_rate * (kernel\_height - 1) + 1)}{stride\_height} + 1\rfloor$

$output\_width = \lfloor\frac{input\_width + 2 * padding\_width - (dilation\_rate * (kernel\_width - 1) + 1)}{stride\_width} + 1\rfloor$

其中， $\lfloor x \rfloor$ 表示对 $x$ 进行向下取整操作。