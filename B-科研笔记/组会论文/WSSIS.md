# 传统的工作问题与挑战

> [!summary]+
> 1. 传统的实例分割方法提供了大量用于训练的分割标签，分割标签需要精细的像素级标注，需要更多的金钱成本和人力。半监督实例分割`SSIS方法`采用少量像素级（完全）标记数据和大量未标记数据。尽管有潜力，但与完全监督学习方法仍然存在很大的性能差距。
> 2. `SSIS方法`通常采用以下训练流水线：如[[WSSIS#^b7f126|图片1]]所示
> （1）用完全标记的数据训练基本网络
> （2）使用基本网络为未标记的图像生成**伪实例掩码**
> （3）使用完整和伪标签训练目标网络。
> 3. `SSIS`方法的主要挑战来自伪标签中缺失（即[[科研名词解释#False negatives and True positives|假阴性]]）和噪声（即**假阳性**）样本数量之间的**权衡**。但是它们的减少`false-negatives`的策略，相当于增加`true-positives`，往往以相应增加**假阳性**而告终，伪标签的含有的这些**假阳性**和**假阴性**严重阻碍了目标网络的稳定收敛



# 作者提出的工作

^p1
![image.png|450](https://article.biliimg.com/bfs/article/b2cb9b6bb6ad47e8b64d8ff7709312087b88131a.png) ^b7f126
大多数现有的实例分割方法采用两步推理过程
- 生成实例[[科研名词解释#proposals|Proposal]]，其中实例在`Proposal Branch`中表示为**框**或**点**，
- 在掩码分支中为每个实例`Proposal`生成实例掩码。

作者认为网络未能获得**实例建议**（即**假阴性建议**），它就不能产生相应的**实例掩码**。虽然网络可以在**掩码分支中**表示实例掩码，但是建议的缺失成为产生实例掩码的`bottleneck`。 ^112

## 创新点

> [!note]+ 创新点
> 1. 作者根据**点标签**提出了`WSSIS`,使用点标签**过滤掉建议**，只保留**真正建议**。
> 2. 我们考虑了**特征金字塔网络**的特征，该网络由用于多尺度实例识别的多级特征图组成。如[[WSSIS#^p4-1|图4]]所示每个金字塔级别都被训练来识别特定大小的实例，从不合适的级别提取实例掩码通常会导致不准确的预测。
> 3. 由于点标签没有**实例大小信息**，我们使用一种名为**自适应选择金字塔**的有效策略来处理这个问题。我们基于网络的可靠性（即，**置信度得分**）来估计哪个级别是最适合的，然后在所选级别自适应地产生**实例掩码**。
> 4. 作者还发现在极其有限的完全标记的数据上，网络经常**不能充分**表示掩码分支中的实例掩码，导致**粗糙**和**有噪声**的掩码输出。在这种情况下，真正建议并不总是导致真正实例掩码。为解决这个问题提出了一个`MaskRefineNet`来**细化**粗略的实例掩码。 ^12
> 5. `MaskRefineNet`采用三个输入源：
> 	- **图像**：提供关于目标实例的视觉信息
> 	- **粗糙蒙版**：用于细化的一种**先验知识**
> 	- **点**：明确地引导目标实例




^p4
![image.png](https://article.biliimg.com/bfs/article/c888eab275e217a5a2c49519c48f52e458a5a670.png)
^p4-1


# 方法

根据上面[[WSSIS#^112|作者说]]的改进**proposal分支**对模型性能更关键，他们在**proposal分支**中调整一个**置信度阈值**，来验证`proposal`对输出实例掩码的影响，

![image.png](https://article.biliimg.com/bfs/article/e334de043c7a6fa40c27c1f95b488b022d312dac.png)

如上图，0.1的低阈值下，随着提议数量的增加，我们获得了更多的真阳性掩码，但也获得了更多的假阳性掩码。当提高到0.5时，我们会丢失几个在较低阈值下检测到的真阳性掩模。作者认为**尽管掩码分支可以表示实例掩码，但是缺少阈值建议会导致缺少实例掩码**。

## WSSIS

WSSIS两步学习过程：
> [!tldr]+
> - 用**完整标签**trian教师网络
> - 使用教师网络生成的伪标签和点标签一起训练学生网络，这里点标签用来过滤`proposal`,留下真的`proposal`，然后教师网络的掩码表示来生成实例掩码。

 ^p3
![image.png](https://article.biliimg.com/bfs/article/87d42a66fa5b1066f75d57af69458c5f3dabf0bb.png)
^p3
# Strategy of using pyramid-level adaptively

如[[WSSIS#^p4-1|图4]]所示，我们可以知道基于实例的大小提取`proposal`非常重要，**自适应选择金字塔**，基于网络的可靠性自适应地选择。
> [!abstract]+
> - 根据每个级别的分辨率重新缩放点标签的坐标，并提取所有级别的**置信度分数**。
> - 只从具有**最大置信度分数**的金字塔级别生成一个实例掩码，每一个点标签`（x，y，c）` c代表类别id
> - 将置信度分数作为预测的可靠性，我们自适应地选择一个具有最大分数的金字塔级别



## Mask Refinement Network

[[WSSIS#^12|如上文]], `MaskRefineNet`是一个**后处理蒙版细化**方法，过程如下
> [!summary]+
> 1. 锁定每个实例区域-对于每个**图像实例**，我们都在原始图像、粗略蒙版和点信息中截取相应的实例区域，并对这些区域进行宽松的剪裁和256×256的调整，并将它们拼接成一个输入张量。
> 2. 创建点信息热图-对于点信息，我们将点标签转化为热图的形式。其中每个点都被编码成2D高斯核，σ为6.



`MaskRefineNet`的有效性可归因于两个原因；

> [!summary]+
> 1. 利用`teacher network`的先验知识- `MaskRefineNet`以来自`teacher network`的粗略蒙版预测作为输入，从而学习如何校准`teacher network`之间的常见错误。
> 2. 采用基于**点信息**的指导-MaskRefineNet来指导细化过程，这样可以提供准确的目标实例线索，协助区分重叠的实例，并消除误判的像素。


[[WSSIS#^p3|图3]]

MaskRefineNet是一个简单而有效的后处理蒙版细化方法，用于改善原始蒙版网络输出的粗略蒙版。其过程如下：
> [!summary]+
> 1. 锁定每个实例区域-对于每个图像实例，我们都在原始图像、粗略蒙版和点信息中截取相应的实例区域，并对这些区域进行宽松的剪裁和256×256的调整，并将它们拼接成一个输入张量。
> 2. 创建点信息热图-对于点信息，我们将点标签转化为热图的形式。其中每个点都被编码成2D高斯核，σ为6.
> 3. 利用`teacher network`的先验知识- `MaskRefineNet`以来自`teacher network`的粗略蒙版预测作为输入，从而学习如何校准`teacher network`之间的常见错误。
> 4. 采用基于点信息的指导-MaskRefineNet采用点信息来指导细化过程，这样可以提供准确的目标实例线索，协助区分重叠的实例，并消除误判的像素。

综合以上四个步骤，MaskRefineNet可以有效地调节蒙版预测的错误，并分离目标实例，从而提高伪标签质量。

# 实验


![image.png](https://article.biliimg.com/bfs/article/dae3bd583c7e07d77a2e70ba30cf4f8b6441dcb5.png)




![image.png](https://article.biliimg.com/bfs/article/d8dd44db44e5bf17ecb696024d2694d5f6da46bb.png)

用固定数量的7k全标记数据来增加点标记数据的数量时，性能会逐渐提高




![image.png](https://article.biliimg.com/bfs/article/f5a83447d6ed4216c6c7129bb40e974a8db6ffe0.png)

验证了实例分割中每个弱标签候选（即，未标记、图像级别和点标签）的有效性



![image.png](https://article.biliimg.com/bfs/article/b4da6f3ce0516ef0ab93687b4bde15c7eee80032.png)

